# 通信协议

TCP/IP 协议套件是计算机网络（因特网）通信的协议，定义计算机网络连接和数据传输标准。

通信协议包括：

- TCP（传输控制协议）：应用程序之间的通信

- UDP (用户数据包协议)：应用程序之间的简单通信

- IP（网际协议）：计算机之间的通信

- DHCP（动态主机配置协议）：针对动态寻址

## TCP

一种网络应用程序之间的通信协议，提供可靠的（丢包可重传）、面向连接的传输服务。

**三次握手**

TCP 通过三次握手，保证了通信的可靠性；

主动发起请求的一端称为客户端，被动连接的一端称为服务端。
不管是客户端还是服务端，TCP 连接建立完后都能收发数据，所以 TCP 是一个全双工的协议。

整个过程双发完成数据通讯初始序号交换，且都向对方发送了确认；

1. 客户端发送一个 SYN（SYNchronize 同步）报文给服务器，包含自身的数据通讯初始序号，表示希望建立连接。在这个阶段，客户端进入 SYN-SENT 状态。

2. 服务器收到 SYN 报文后，发送一个包含 SYN 和 ACK（Acknowledge 确认）标志的报文给客户端，确认收到连接请求，并同意建立连接。此时，服务器进入 SYN-RECEIVED 状态。

3. 当客户端收到连接同意的应答后，还要向服务端发送一个应答（ACK）报文。客户端发完这个报文段后便进入 ESTABLISHED 状态，服务端收到这个应答后也进入 ESTABLISHED 状态，此时连接建立成功。

一定要挥手三次的原因：防止已失效的连接请求报文段突然又传送到了服务端，因而产生错误

**四次挥手**

数据传送完毕，肯定是要断开 TCP 连接，四次挥手确保数据传输完毕。

整个过程双发完成发送 FIN 报文，且都向对方回应了确认；

1. 主动关闭方（通常是客户端）发送一个 FIN（finish 结束）报文给另一方，表示希望关闭连接。此时，主动关闭方进入 FIN-WAIT-1 状态。

2. 被动关闭方（通常是服务器）收到 FIN 报文后，发送一个 ACK（确认）报文给主动关闭方，确认接收到关闭请求。此时，被动关闭方进入 CLOSE-WAIT 状态，而主动关闭方则进入 FIN-WAIT-2 状态。

3. 被动关闭方在确认当前的数据传输完毕后，发送一个 FIN 报文给主动关闭方，表示同意关闭连接。此时，被动关闭方进入 LAST-ACK 状态。

4. 主动关闭方收到被动关闭方的 FIN 报文后，发送一个 ACK 报文确认关闭请求，进入 TIME-WAIT 状态，等待一段时间以确保被动关闭方接收到该确认。随后，主动关闭方进入 CLOSED 状态，表示连接已成功关闭。而被动关闭方在收到此 ACK 后也进入 CLOSED 状态，连接彻底关闭。

四次挥手的原因：TCP 是全双工通信，保证双方都无数据发送而完整关闭。

## UDP

一种网络应用程序之间的通信协议，面向无连接的（直接发送）、高效的、不可靠的传输服务。

# 
